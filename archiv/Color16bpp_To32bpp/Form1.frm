VERSION 5.00
Begin VB.Form Form1 
   Caption         =   "Form1"
   ClientHeight    =   3015
   ClientLeft      =   120
   ClientTop       =   465
   ClientWidth     =   7935
   LinkTopic       =   "Form1"
   ScaleHeight     =   3015
   ScaleWidth      =   7935
   StartUpPosition =   3  'Windows-Standard
   Begin VB.CommandButton Command2 
      Caption         =   "16bpp RGB565"
      Height          =   375
      Left            =   2400
      TabIndex        =   1
      Top             =   120
      Width           =   2175
   End
   Begin VB.CommandButton Command1 
      Caption         =   "16bpp ARGB1555"
      Height          =   375
      Left            =   120
      TabIndex        =   0
      Top             =   120
      Width           =   2175
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   31
      Left            =   7320
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   30
      Left            =   6840
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   29
      Left            =   6360
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   28
      Left            =   5880
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   27
      Left            =   5400
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   26
      Left            =   4920
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   25
      Left            =   4440
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   24
      Left            =   3960
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   23
      Left            =   3480
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   22
      Left            =   3000
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   21
      Left            =   2520
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   20
      Left            =   2040
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   19
      Left            =   1560
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   18
      Left            =   1080
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   17
      Left            =   600
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   16
      Left            =   120
      Top             =   1080
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   15
      Left            =   7320
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   14
      Left            =   6840
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   13
      Left            =   6360
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   12
      Left            =   5880
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   11
      Left            =   5400
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   10
      Left            =   4920
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   9
      Left            =   4440
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   8
      Left            =   3960
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   7
      Left            =   3480
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   6
      Left            =   3000
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   5
      Left            =   2520
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   4
      Left            =   2040
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   3
      Left            =   1560
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   2
      Left            =   1080
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   1
      Left            =   600
      Top             =   600
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BackStyle       =   1  'Undurchsichtig
      BorderStyle     =   0  'Transparent
      Height          =   495
      Index           =   0
      Left            =   120
      Top             =   600
      Width           =   495
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Type TByt2
    Value0 As Byte
    Value1 As Byte
End Type

Private Type TInt
    Value As Integer
End Type

Private m_data() As Byte

Private RedMask   As Integer
Private GreenMask As Integer
Private BlueMask  As Integer
Private AlphaMask As Integer

Private Function Color16bppBGRA1555_ToColor32(ByVal Value As Integer) As Long
    Dim r As Integer, g As Integer, b As Integer, a As Integer
    Const Mask5Bit As Integer = &H1F
    Const Mask6Bit As Integer = &H20
    b = (Value And BlueMask) * 255 / Mask5Bit
    g = (Value And GreenMask) / BlueMask * 255 / Mask5Bit
    r = (Value And RedMask) / GreenMask * 255 / Mask5Bit
    a = (Value And AlphaMask) / RedMask * 255 ' alpha is only 1 bit, so it is 0 or 1, resp 0 or 255
    Color16bppBGRA1555_ToColor32 = RGB(r, g, b)
End Function

Private Function Color16bppBGR565_ToColor32(ByVal Value As Integer) As Long
    Dim r As Integer, g As Integer, b As Integer, a As Integer
    Const Mask5Bit As Integer = &H1F
    Const Mask6Bit As Integer = &H20
    b = (Value And BlueMask) * 255 / Mask5Bit
    g = (Value And GreenMask) / BlueMask * 255 / Mask6Bit
    r = (Value And RedMask) / GreenMask * 255 / Mask5Bit
    a = (Value And AlphaMask) / RedMask * 255 ' alpha is not included
    Color16bppBGR565_ToColor32 = RGB(r, g, b)
End Function

Sub SetColors_BGRA1555()
    ReDim m_data(0 To 63) As Byte
    Dim i As Long
    m_data(i) = &HFF: i = i + 1:    m_data(i) = &H7F: i = i + 1
    m_data(i) = &H0:  i = i + 1:    m_data(i) = &H0:  i = i + 1
    m_data(i) = &H0:  i = i + 1:    m_data(i) = &H7C: i = i + 1
    m_data(i) = &HE0: i = i + 1:    m_data(i) = &H3:  i = i + 1
    m_data(i) = &H1F: i = i + 1:    m_data(i) = &H0:  i = i + 1
    m_data(i) = &HE0: i = i + 1:    m_data(i) = &H7F: i = i + 1
    m_data(i) = &H1F: i = i + 1:    m_data(i) = &H7C: i = i + 1
    m_data(i) = &HFF: i = i + 1:    m_data(i) = &H3:  i = i + 1
    m_data(i) = &H0:  i = i + 1:    m_data(i) = &H40: i = i + 1
    m_data(i) = &H0:  i = i + 1:    m_data(i) = &H2:  i = i + 1
    m_data(i) = &H10: i = i + 1:    m_data(i) = &H0:  i = i + 1
    m_data(i) = &H10: i = i + 1:    m_data(i) = &H40: i = i + 1
    m_data(i) = &H0:  i = i + 1:    m_data(i) = &H42: i = i + 1
    m_data(i) = &H10: i = i + 1:    m_data(i) = &H2:  i = i + 1
    m_data(i) = &H10: i = i + 1:    m_data(i) = &H42: i = i + 1
    m_data(i) = &HF7: i = i + 1:    m_data(i) = &H5E: i = i + 1
    
    
    m_data(i) = &H3D: i = i + 1:    m_data(i) = &H53: i = i + 1
    m_data(i) = &HB9: i = i + 1:    m_data(i) = &H53: i = i + 1
    m_data(i) = &H9D: i = i + 1:    m_data(i) = &H66: i = i + 1
    m_data(i) = &H99: i = i + 1:    m_data(i) = &H76: i = i + 1
    m_data(i) = &H34: i = i + 1:    m_data(i) = &H77: i = i + 1
    m_data(i) = &HB4: i = i + 1:    m_data(i) = &H67: i = i + 1
    m_data(i) = &H22: i = i + 1:    m_data(i) = &H22: i = i + 1
    m_data(i) = &H51: i = i + 1:    m_data(i) = &H64: i = i + 1
    m_data(i) = &H22: i = i + 1:    m_data(i) = &H47: i = i + 1
    m_data(i) = &H59: i = i + 1:    m_data(i) = &H44: i = i + 1
    m_data(i) = &H39: i = i + 1:    m_data(i) = &HA:  i = i + 1
    m_data(i) = &H31: i = i + 1:    m_data(i) = &HB:  i = i + 1
    m_data(i) = &H7E: i = i + 1:    m_data(i) = &H6:  i = i + 1
    m_data(i) = &HA7: i = i + 1:    m_data(i) = &H7A: i = i + 1
    m_data(i) = &H41: i = i + 1:    m_data(i) = &H7F: i = i + 1
    m_data(i) = &HAC: i = i + 1:    m_data(i) = &H7F: i = i + 1
End Sub

Sub SetColors_BGR565()
    ReDim m_data(0 To 63) As Byte
    Dim i As Long
    m_data(i) = &HFF: i = i + 1:    m_data(i) = &HFF: i = i + 1
    m_data(i) = &H0:  i = i + 1:    m_data(i) = &H0:  i = i + 1
    m_data(i) = &H0:  i = i + 1:    m_data(i) = &HF8: i = i + 1
    m_data(i) = &HE0: i = i + 1:    m_data(i) = &H7:  i = i + 1
    m_data(i) = &H1F: i = i + 1:    m_data(i) = &H0:  i = i + 1
    m_data(i) = &HE0: i = i + 1:    m_data(i) = &HFF: i = i + 1
    m_data(i) = &H1F: i = i + 1:    m_data(i) = &HF8: i = i + 1
    m_data(i) = &HFF: i = i + 1:    m_data(i) = &H7:  i = i + 1
    m_data(i) = &H0:  i = i + 1:    m_data(i) = &H80: i = i + 1
    m_data(i) = &H20: i = i + 1:    m_data(i) = &H4:  i = i + 1
    m_data(i) = &H10: i = i + 1:    m_data(i) = &H0:  i = i + 1
    m_data(i) = &H10: i = i + 1:    m_data(i) = &H80: i = i + 1
    m_data(i) = &H20: i = i + 1:    m_data(i) = &H84: i = i + 1
    m_data(i) = &H30: i = i + 1:    m_data(i) = &H4:  i = i + 1
    m_data(i) = &H30: i = i + 1:    m_data(i) = &H84: i = i + 1
    m_data(i) = &HFF: i = i + 1:    m_data(i) = &HBD: i = i + 1
    
    
    m_data(i) = &H7D: i = i + 1:    m_data(i) = &HA6: i = i + 1
    m_data(i) = &H79: i = i + 1:    m_data(i) = &HA7: i = i + 1
    m_data(i) = &H3D: i = i + 1:    m_data(i) = &HCD: i = i + 1
    m_data(i) = &H39: i = i + 1:    m_data(i) = &HED: i = i + 1
    m_data(i) = &H74: i = i + 1:    m_data(i) = &HEE: i = i + 1
    m_data(i) = &H74: i = i + 1:    m_data(i) = &HCF: i = i + 1
    m_data(i) = &H62: i = i + 1:    m_data(i) = &HCC: i = i + 1
    m_data(i) = &H91: i = i + 1:    m_data(i) = &HC8: i = i + 1
    
    m_data(i) = &H22: i = i + 1:    m_data(i) = &H47: i = i + 1
    m_data(i) = &H59: i = i + 1:    m_data(i) = &H44: i = i + 1
    m_data(i) = &H39: i = i + 1:    m_data(i) = &HA:  i = i + 1
    m_data(i) = &H31: i = i + 1:    m_data(i) = &HB:  i = i + 1
    m_data(i) = &H7E: i = i + 1:    m_data(i) = &H6:  i = i + 1
    m_data(i) = &HA7: i = i + 1:    m_data(i) = &H7A: i = i + 1
    m_data(i) = &H41: i = i + 1:    m_data(i) = &H7F: i = i + 1
    m_data(i) = &HAC: i = i + 1:    m_data(i) = &H7F: i = i + 1
    
    
'FF FF
'00 00
'0  F8
'E0 7
'1 F 0
'E0 FF
'1 F F8
'FF 7
'00 80
'20 04
'10 00
'10 80
'20 84
'30 04
'30 84
'F7 BD
'
'
'
'7D A6
'79 A7
'3D CD
'39 ED
'74 EE
'74 CF
'62 CC
'91 C8  62 8E  99 88  79 14  71 16  FE 0C  67 F5  A1 FE  6C FF
    
End Sub

Sub SetMask_BGRA1555()
     BlueMask = &H1F    ' 5 bit
    GreenMask = &H3E0   ' 5 bit
      RedMask = &H7C00  ' 5 bit
    AlphaMask = &H8000  ' 1 bit
End Sub

Sub SetMask_BGR565()
     BlueMask = &H1F    ' 5 bit
    GreenMask = &H7E0   ' 6 bit
      RedMask = &HF800  ' 5 bit
    AlphaMask = &H0     ' ----
End Sub

Private Sub Command1_Click()
    SetColors_BGRA1555
    SetMask_BGRA1555
    Dim tb As TByt2, ti As TInt
    Dim i As Long, j As Long
    For i = 0 To 31
        tb.Value0 = m_data(j): j = j + 1
        tb.Value1 = m_data(j): j = j + 1
        LSet ti = tb
        Shape1(i).BackColor = Color16bppBGRA1555_ToColor32(ti.Value)
    Next
End Sub

Private Sub Command2_Click()
    SetColors_BGR565
    SetMask_BGR565
    Dim tb As TByt2, ti As TInt
    Dim i As Long, j As Long
    For i = 0 To 31
        tb.Value0 = m_data(j): j = j + 1
        tb.Value1 = m_data(j): j = j + 1
        LSet ti = tb
        Shape1(i).BackColor = Color16bppBGR565_ToColor32(ti.Value)
    Next
End Sub

